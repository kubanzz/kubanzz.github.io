(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{376:function(e,n,t){"use strict";t.r(n);var s=t(12),r=Object(s.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("blockquote",[n("p",[e._v("最近在学习Spring的相关模块及源码，在学习Bean的相关创建方法时，发现spring的bean一般都是单例模式，在xml中可以通过"),n("code",[e._v("scope=prototype")]),e._v("、注解中可以通过"),n("code",[e._v('@Scope("prototypr")')]),e._v("设置为多例模式（"),n("code",[e._v("singleton")]),e._v("为单例模式），不禁想到自己项目组中的Spring MVC中使用的是单例还是多例？下面是对Controller层的代码测试：")])]),e._v(" "),n("p"),e._v(" "),n("h2",{attrs:{id:"_1、spring-mvc的单例和多例测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、spring-mvc的单例和多例测试"}},[e._v("#")]),e._v(" 1、Spring MVC的单例和多例测试")]),e._v(" "),n("ul",[n("li",[e._v("下面代码中在controller层中加入成员变量（此处添加只为测试，为非线程安全），现在通过调用此url接口，发现输出的test分别为："),n("code",[e._v("1,2,3...")]),e._v("，说明conreoller层为单例模式，只生成了一个实例，加入"),n("code",[e._v('@Scope("prototype")')]),e._v("的注解后，输出结果为："),n("code",[e._v("1,1,1...")]),e._v("，说明为多例模式(原型模式)，每次请求都会生成对象。")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('@Controller\n@RequestMapping("/api/login")\npublic class LoginController {\n\n    private Logger logger = LoggerFactory.getLogger(this.getClass());\n    \n    private int test = 1; //非线程安全\n    \n    @Autowired\n    private LoginService loginService;\n\n    @Autowired\n    private LoginDao loginDao;\n\n    @RequestMapping(value = "/admin", method = RequestMethod.GET)\n    public void adminLogin() {\n    \tSystem.out.println(test ++);\n    }\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br")])]),n("p"),e._v(" "),n("h2",{attrs:{id:"_2、单例和多例的应用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、单例和多例的应用场景"}},[e._v("#")]),e._v(" 2、单例和多例的应用场景")]),e._v(" "),n("ul",[n("li",[e._v("如果对象是"),n("code",[e._v("无状态的")]),e._v("（如上面的LoginService），或者对象的成员变量（共享）是线程安全的，如静态变量，常量，Threadlocal变量等，则可以使用单例模式，这样在性能上能够大大提升，减少了实例对象的开销。")]),e._v(" "),n("li",[e._v("如果对象存在线程不安全的变量，则需要采用"),n("code",[e._v("多例模式")]),e._v("，否则会出现线程安全问题。（一般情况下都是将变量修改为线程安全模式），所以在controller的编程中尽量不要出现成员变量。")])]),e._v(" "),n("p"),e._v(" "),n("h2",{attrs:{id:"_3、单例模式的扩展"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、单例模式的扩展"}},[e._v("#")]),e._v(" 3、单例模式的扩展")]),e._v(" "),n("ul",[n("li",[e._v("单例模式有懒汉模式和饿汉模式\n"),n("ul",[n("li",[n("strong",[e._v("饿汉模式")]),e._v("：在启动Bean容器时，为xml中配置的bean都实例化一个对象（"),n("code",[e._v("Spring的默认形式")]),e._v("）")]),e._v(" "),n("li",[n("strong",[e._v("懒汉模式")]),e._v("：第一个请求时才创建实例，后续的请求都使用此实例。")])])])]),e._v(" "),n("p"),e._v(" "),n("h4",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://blog.csdn.net/qianyiyiding/article/details/77104736",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考一"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://blog.csdn.net/qq_35661171/article/details/83180546",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考二"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=r.exports}}]);