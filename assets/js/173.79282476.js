(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{498:function(t,_,v){"use strict";v.r(_);var s=v(12),r=Object(s.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h2",{attrs:{id:"一、modbus基础信息"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#一、modbus基础信息"}},[t._v("#")]),t._v(" 一、Modbus基础信息")]),t._v(" "),_("h3",{attrs:{id:"定义"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[t._v("#")]),t._v(" 定义")]),t._v(" "),_("blockquote",[_("p",[t._v("MODBUS协议是一种应用层报文传输协议，协议本身并没有定义物理层，定义了控制器能够认识和使用的消息结构，不管它们是经过何种网络进行通信的，所以能够适应多种电气接口，常用于工业电子设备间的通信。Modbus的优点：")]),t._v(" "),_("ul",[_("li",[t._v("Modbus协议标准开放、公开发表且无版权要求")]),t._v(" "),_("li",[t._v("Modbus协议支持多种电气接口，包括RS232、RS485、TCP/IP等，还可以在各种介质上传输，如双绞线、光纤、红外、无线等")]),t._v(" "),_("li",[t._v("Modbus协议消息帧格式简单、紧凑、通俗易懂。用户理解和使用简单，厂商容易开发和集成，方便形成工业控制网络")])])]),t._v(" "),_("h3",{attrs:{id:"通信过程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#通信过程"}},[t._v("#")]),t._v(" 通信过程")]),t._v(" "),_("blockquote",[_("p",[t._v("Modbus是一主多从的通信协议，其通信过程如下："),_("strong",[t._v("主机在同一时间内只能向一个从机发送请求，总线上每次只有一个数据进行传输")]),t._v(",即主机发送，从机应答，主机不发送，总线上就没有数据通信。")])]),t._v(" "),_("p",[_("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images/6545b8a54f6841309802ceb9586b17bf.png",alt:"在这里插入图片描述"}})]),t._v(" "),_("h3",{attrs:{id:"传输模式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#传输模式"}},[t._v("#")]),t._v(" 传输模式")]),t._v(" "),_("p",[t._v("Modbus可以在各种介质上传输，那么他的传输模式也分为三种。包括"),_("strong",[t._v("ASCII、RTU(远程终端控制系统)、TCP")]),t._v("三种报文类型。")]),t._v(" "),_("p",[t._v("基于以上的传输类型，目前存在多个版本的Modbus协议，最常见的是以下四种：")]),t._v(" "),_("ul",[_("li",[t._v("Modbus-RTU：采用16位CRC校验")]),t._v(" "),_("li",[t._v("Modbus-ASCII：采用LRC校验")]),t._v(" "),_("li",[t._v("Modbus-TCP：不采用校验，因为TCP为面向连接的可靠协议")]),t._v(" "),_("li",[t._v("ModbusPlus")])]),t._v(" "),_("h3",{attrs:{id:"内存模型"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#内存模型"}},[t._v("#")]),t._v(" 内存模型")]),t._v(" "),_("p",[t._v("Modbus存储区域的数据类型可以分为：布尔量和16位寄存器，主机向从机获取数据时，只需要告诉从机数据的起始地址，还有获取多少字节的数据，从机就可以发送数据给主机。")]),t._v(" "),_("ul",[_("li",[_("strong",[t._v("布尔量")]),t._v("：比如IO口的电平高低，灯的开关状态等")]),t._v(" "),_("li",[_("strong",[t._v("16位寄存器")]),t._v("：比如传感器的温度数据，存储的密码等")])]),t._v(" "),_("p",[t._v("Modbus规定了4个存储区域，分别是0 1 3 4区， 其中1区和4区是可读可写，1区和3区是只读。")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("区号")]),t._v(" "),_("th",[t._v("名称")]),t._v(" "),_("th",[t._v("读写")]),t._v(" "),_("th",[t._v("地址范围")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("0区")]),t._v(" "),_("td",[t._v("输出线圈")]),t._v(" "),_("td",[t._v("可读可写布尔量")]),t._v(" "),_("td",[t._v("00001-09999")])]),t._v(" "),_("tr",[_("td",[t._v("1区")]),t._v(" "),_("td",[t._v("输入线圈")]),t._v(" "),_("td",[t._v("只读布尔量")]),t._v(" "),_("td",[t._v("10001-19999")])]),t._v(" "),_("tr",[_("td",[t._v("3区")]),t._v(" "),_("td",[t._v("输入寄存器")]),t._v(" "),_("td",[t._v("只读寄存器")]),t._v(" "),_("td",[t._v("30001-39999")])]),t._v(" "),_("tr",[_("td",[t._v("4区")]),t._v(" "),_("td",[t._v("保持寄存器")]),t._v(" "),_("td",[t._v("可读可写寄存器")]),t._v(" "),_("td",[t._v("40001-49999")])])])]),t._v(" "),_("h3",{attrs:{id:"报文格式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#报文格式"}},[t._v("#")]),t._v(" 报文格式")]),t._v(" "),_("blockquote",[_("p",[t._v("ModBus协议的设备通常将业务数据存储在寄存器中")]),t._v(" "),_("ul",[_("li",[_("strong",[t._v("每个寄存器：两个字节")])])])]),t._v(" "),_("p",[_("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images/1ee51a10afa14700a83c43099ccda2b3.png",alt:"在这里插入图片描述"}})]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("从站地址")]),t._v(" "),_("th",[t._v("功能码")]),t._v(" "),_("th",[t._v("数据")]),t._v(" "),_("th",[t._v("CRC/LRC")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("1 byte")]),t._v(" "),_("td",[t._v("1 byte")]),t._v(" "),_("td",[t._v("N bytes")]),t._v(" "),_("td",[t._v("2 bytes")])])])]),t._v(" "),_("ul",[_("li",[_("strong",[t._v("从机地址")]),t._v("： "),_("strong",[t._v("每个从机都有唯一地址，占用一个字节")]),t._v("，范围0-255，其中有效范围是1-247，其中255是"),_("a",{attrs:{href:"https://so.csdn.net/so/search?q=%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[t._v("广播地址"),_("OutboundLink")],1),t._v("(广播就是对所有从机发送应答)")]),t._v(" "),_("li",[_("strong",[t._v("功能码")]),t._v("： 占用一个字节，"),_("strong",[t._v("功能码的意义就是，知道这个指令是干啥的，比如你可以查询从机的数据，也可以修改从机的数据")]),t._v("，所以不同功能码对应不同功能")]),t._v(" "),_("li",[_("strong",[t._v("数据")]),t._v("： 根据功能码不同，有不同功能，比方说功能码是查询从机的数据，这里就是查询寄存器的地址和查询的寄存器数量等")]),t._v(" "),_("li",[_("strong",[t._v("校验")]),t._v("： "),_("strong",[t._v("在数据传输过程中可能数据会发生错误，CRC检验检测接收的数据是否正确")])])]),t._v(" "),_("p",[_("strong",[t._v("CRC校验流程")]),t._v("：")]),t._v(" "),_("ol",[_("li",[t._v("预置一个16位寄存器为0FFFFH（全1），称之为CRC寄存器。")]),t._v(" "),_("li",[t._v("把数据帧中的第一个字节的8位与CRC寄存器中的低字节进行异或运算，结果存回CRC寄存器。")]),t._v(" "),_("li",[t._v("将CRC寄存器向右移一位，最高位填以0，最低位移出并检测。")]),t._v(" "),_("li",[t._v("如果最低位为0：重复第三步（下一次移位）；如果最低位为1：将CRC寄存器与一个预设的固定值（0A001H）进行异或运算。")]),t._v(" "),_("li",[t._v("重复第三步和第四步直到8次移位。这样处理完了一个完整的八位。")]),t._v(" "),_("li",[t._v("重复第2步到第5步来处理下一个八位，直到所有的字节处理结束。")]),t._v(" "),_("li",[t._v("最终CRC寄存器的值就是CRC的值。")])]),t._v(" "),_("h2",{attrs:{id:"二、参考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#二、参考"}},[t._v("#")]),t._v(" 二、参考")]),t._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"https://blog.csdn.net/as480133937/article/details/123197782?spm=1001.2014.3001.5502",target:"_blank",rel:"noopener noreferrer"}},[t._v("*Modbus协议"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/390196128",target:"_blank",rel:"noopener noreferrer"}},[t._v("*图解Modbus协议"),_("OutboundLink")],1)])])])}),[],!1,null,null,null);_.default=r.exports}}]);