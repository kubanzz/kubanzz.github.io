(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{435:function(e,s,a){"use strict";a.r(s);var n=a(12),t=Object(n.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"一、oozie组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、oozie组件"}},[e._v("#")]),e._v(" 一、Oozie组件")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("Workflow")]),e._v("：工作流（流程图）\n"),s("ul",[s("li",[e._v("常用结点：\n"),s("ul",[s("li",[e._v("控制流结点（Control Flow Nodes）\n"),s("ul",[s("li",[e._v("start、end、kill、分支、合并等")])])]),e._v(" "),s("li",[e._v("动作结点（Action Nodes）")])])])])]),e._v(" "),s("li",[s("code",[e._v("Coordinator")]),e._v("：定时器")]),e._v(" "),s("li",[s("code",[e._v("Bundle Job")]),e._v("：绑定多个Coordinator")])]),e._v(" "),s("h2",{attrs:{id:"二、环境搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、环境搭建"}},[e._v("#")]),e._v(" 二、环境搭建")]),e._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://www.bilibili.com/video/av35357845/?p=4&spm_id_from=333.788.b_6d756c74695f70616765.4",target:"_blank",rel:"noopener noreferrer"}},[e._v("学习网站"),s("OutboundLink")],1)])]),e._v(" "),s("li",[s("p",[e._v("下面记录的是一些零碎的过程")]),e._v(" "),s("ul",[s("li",[e._v("将依赖的Lib上传到Hdfs中")]),e._v(" "),s("li",[e._v("创建Oozie.sql文件，运行该文件自动生成表（可以通过Navicat查看）")]),e._v(" "),s("li",[e._v("启动Oozie "),s("code",[e._v("bin/oozied.sh start")])]),e._v(" "),s("li",[s("code",[e._v("jps -l")]),e._v("：查看运行的Java类，其中"),s("code",[e._v("Bootstrap")]),e._v("表明"),s("code",[e._v("Oozie")]),e._v("启动成功")])])])]),e._v(" "),s("h2",{attrs:{id:"三、oozie-shell的编写及启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、oozie-shell的编写及启动"}},[e._v("#")]),e._v(" 三、Oozie shell的编写及启动：")]),e._v(" "),s("ul",[s("li",[e._v("工作流程\n"),s("ul",[s("li",[e._v("编写"),s("code",[e._v("job.properties")]),e._v("及"),s("code",[e._v("workflow.xml")])]),e._v(" "),s("li",[e._v("将文件上传到Haoop的HDFS中")]),e._v(" "),s("li",[e._v("通过命令执行oozie任务")]),e._v(" "),s("li",[e._v("查看oozie的执行页面：http://hh:11000/oozie/\n"),s("br")])])])]),e._v(" "),s("p",[s("strong",[e._v("文件编写：")])]),e._v(" "),s("ul",[s("li",[e._v("job.poperties配置：\n"),s("ul",[s("li",[e._v("指定"),s("code",[e._v("NameNode")]),e._v("（HDFS）和"),s("code",[e._v("JobTracker")]),e._v("（Yarn）")]),e._v(" "),s("li",[e._v("指定"),s("code",[e._v("workflow")]),e._v("在HDFS中的路径")])])])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("nameNode=hdfs://hh:8020     # hdfs地址\njobTracker=hh:8032          # yarn地址\nqueueName=default           \nexamplesRoot=shell\n\noozie.wf.application.path=${nameNode}/oozie/workflows/example/oozie-example/apps/${examplesRoot}/                    # workflow上传到HDFS后的地址\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("ul",[s("li",[e._v("workflow.xml配置（官方例子）：\n"),s("ul",[s("li",[e._v("注意下面配置中，"),s("code",[e._v("xmlns")]),e._v("版本与"),s("code",[e._v("oozie-site.xml")]),e._v("的版本需要一致，否则会报无法识别的错误")])])])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('<workflow-app xmlns="uri:oozie:workflow:0.3" name="shell-wf">\n    <start to="shell-node"/>\n    <action name="shell-node">\n        <shell xmlns="uri:oozie:shell-action:0.1">\n            <job-tracker>${jobTracker}</job-tracker>\n            <name-node>${nameNode}</name-node>\n            <configuration>\n                <property>\n                    <name>mapred.job.queue.name</name>\n                    <value>${queueName}</value>\n                </property>\n            </configuration>\n            <exec>echo</exec>\n            <argument>my_output=Hello Oozie</argument>\n            <capture-output/>\n        </shell>\n        <ok to="check-output"/>\n        <error to="fail"/>\n    </action>\n    <decision name="check-output">\n        <switch>\n            <case to="end">\n                ${wf:actionData(\'shell-node\')[\'my_output\'] eq \'Hello Oozie\'}\n            </case>\n            <default to="fail-output"/>\n        </switch>\n    </decision>\n    <kill name="fail">\n        <message>Shell action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>\n    </kill>\n    <kill name="fail-output">\n        <message>Incorrect output, expected [Hello Oozie] but was [${wf:actionData(\'shell-node\')[\'my_output\']}]</message>\n    </kill>\n    <end name="end"/>\n</workflow-app>\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br"),s("span",{staticClass:"line-number"},[e._v("31")]),s("br"),s("span",{staticClass:"line-number"},[e._v("32")]),s("br"),s("span",{staticClass:"line-number"},[e._v("33")]),s("br"),s("span",{staticClass:"line-number"},[e._v("34")]),s("br"),s("span",{staticClass:"line-number"},[e._v("35")]),s("br")])]),s("br"),e._v(" "),s("p",[s("strong",[e._v("文件上传")])]),e._v(" "),s("ul",[s("li",[s("code",[e._v("hadoop dfs -put /home/hadoop/oozie-example/apps/shell/* /oozie/workflows/example/oozie-example/apps/shell")])])]),e._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images61775204-09a2c600-ae2b-11e9-9f02-6c7ca55e423d.png",alt:"image"}})]),e._v(" "),s("p",[s("strong",[e._v("执行作业")])]),e._v(" "),s("ul",[s("li",[s("code",[e._v("oozie job -oozie http://hh:11000/oozie -config job.properties -run")]),e._v(" "),s("ul",[s("li",[e._v("其中"),s("code",[e._v("job.properties")]),e._v("为本地的文件，而不是HDFS上的")])])])]),e._v(" "),s("p",[s("strong",[e._v("查看作业")])]),e._v(" "),s("ul",[s("li",[e._v("Oozie访问页面："),s("code",[e._v("http://hh:11000/oozie/")]),e._v(" "),s("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images61775639-e4628780-ae2b-11e9-95ba-931da466633a.png",alt:"image"}})]),e._v(" "),s("li",[e._v("Yarn访问页面："),s("code",[e._v("http://172.20.13.20:8088/cluster")]),e._v(" "),s("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images61775761-1bd13400-ae2c-11e9-8a6a-26f934a3e8ea.png",alt:"image"}})])])])}),[],!1,null,null,null);s.default=t.exports}}]);