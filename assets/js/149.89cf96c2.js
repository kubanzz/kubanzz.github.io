(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{473:function(s,t,a){"use strict";a.r(t);var e=a(12),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"postgres安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#postgres安装"}},[s._v("#")]),s._v(" Postgres安装")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://juejin.cn/post/7124486235703214116",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考一"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/moshowgame/article/details/122794668",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考二*"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://my.huhoo.net/archives/2008/01/windowspostgresqlwindows.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考3"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("问题：安装后服务没有出现postgres服务，并且无法启动数据库")]),s._v(" "),t("p",[s._v("解决：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("启动数据库："),t("code",[s._v("D:\\software\\pgsql\\bin\\pg_ctl.exe -D “D:\\software\\pgsql\\data” start")])])]),s._v(" "),t("li",[t("p",[s._v("初始化data：如果data文件夹是空白的，则执行"),t("code",[s._v("D:\\software\\pgsql>D:\\software\\pgsql\\bin\\pg_ctl.exe -D “D:\\software\\pgsql\\data” initdb")]),s._v("，初始化数据库")])]),s._v(" "),t("li",[t("p",[s._v("注册windows服务："),t("code",[s._v('D:\\software\\pgsql>D:\\software\\pgsql\\bin\\pg_ctl.exe register -N "Postgres" -D "D:\\PostgreSQL\\13\\data"')])])]),s._v(" "),t("li",[t("p",[s._v("在"),t("code",[s._v("services.msc")]),s._v("中找到Postgres服务并启动")])])]),s._v(" "),t("p",[s._v("问题：修改密码无效问题")]),s._v(" "),t("p",[s._v("解决：")]),s._v(" "),t("ol",[t("li",[s._v("将文件"),t("code",[s._v("pg_hba.conf")]),s._v("下的md5改为trust后重启数据库（则不需要输入密码可登录数据库）")])]),s._v(" "),t("p",[t("img",{attrs:{src:"C:/Users/Benjamin/AppData/Roaming/Typora/typora-user-images/image-20221208153408515.png",alt:"image-20221208153408515"}})]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[t("code",[s._v("psql -U postgres")]),s._v("进入数据库命令行界面")]),s._v(" "),t("li",[t("code",[s._v("alter user postgres with password ‘xxxx’;")]),s._v("修改密码")]),s._v(" "),t("li",[t("code",[s._v("pg_hba.conf")]),s._v("重新改回"),t("code",[s._v("md5")]),s._v("后重启数据库则密码有效")])]),s._v(" "),t("p",[s._v("问题：远程连接异常")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/kongxx/article/details/5964638",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考*"),t("OutboundLink")],1)])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("异常：org.postgresql.util.PSQLException: Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.\n\n解决：修改`/var/lib/pgsql/data/postgresql.conf file`。将`\\#listen_addresses = 'localhost'`改为`listen_addresses = '*'`\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('异常：org.postgresql.util.PSQLException: FATAL: no pg_hba.conf entry for host "<host_ip>", user "fkong", database "fkong", SSL off\n\n解决：修改`/var/lib/pgsql/data/pg_hba.conf file`文件，添加下列行\n`host  all     all     all     password`\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"sql语句优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql语句优化"}},[s._v("#")]),s._v(" SQL语句优化")]),s._v(" "),t("ol",[t("li",[s._v("limit 1超时问题\n"),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/luojinbai/article/details/45078809",target:"_blank",rel:"noopener noreferrer"}},[s._v("row_number用法"),t("OutboundLink")],1)])])])]),s._v(" "),t("blockquote",[t("p",[s._v("如下面SQL，采用left join关联数据，两张表都差不多十万左右的数据，目的是获得最新的一条数据，但是就是这么一条简单的语句查询用了二十几秒，直接导致dubbo超时，在排查过程中发现，去除limit 1后，查询时间为秒级别，真是无法理解，在查找了相关信息后，采用了下面的解决方法")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//改前：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("code "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" recordDetailCode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commit_type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publish_result\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" cms_publish_device_t cpdtt\n         "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("left")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v("\n     cms_publish_record_t cprt\n     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" cpdtt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publish_code "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("code\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" device_code "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6662902647412007007")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publish_result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" cpdtt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//改后：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n         "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("code  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" recordDetailCode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commit_type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publish_result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                row_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("over")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" cpdtt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" rn  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//此处还可以添加分组过滤，具体可以查看row_number的用法")]),s._v("\n         "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" cms_publish_device_t\n                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" device_code "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6662902647412007007")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" cpdtt\n                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("left")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" cms_publish_record_t cprt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" cpdtt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publish_code "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("code\n         "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" cprt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publish_result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" t\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("单引号转义\n"),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/weixin_30429201/article/details/101429899",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考"),t("OutboundLink")],1)])])])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("传入时采用“‘目标字符串’”的格式\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);