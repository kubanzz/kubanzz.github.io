(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{464:function(a,e,t){"use strict";t.r(e);var s=t(12),n=Object(s.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"一、arthas"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、arthas"}},[a._v("#")]),a._v(" 一、Arthas")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://arthas.aliyun.com/doc/tunnel.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("文档"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://arthas.aliyun.com/doc/commands.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("常见命令"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.cn/post/6844903745323565064",target:"_blank",rel:"noopener noreferrer"}},[a._v("工具实战"),e("OutboundLink")],1)])]),a._v(" "),e("p",[e("strong",[a._v("依赖包")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("<dependency>\n    <groupId>com.taobao.arthas</groupId>\n    <artifactId>arthas-spring-boot-starter</artifactId>\n    <version>${arthas.version}</version>\n</dependency>\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("h3",{attrs:{id:"单机版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#单机版"}},[a._v("#")]),a._v(" 单机版")]),a._v(" "),e("ul",[e("li",[a._v("访问：http://localhost:3658")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("arthas:\n  tunnel-server: ws://127.0.0.1:7777/ws\n  app-name: event-management-service\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n  endpoint:\n    health:\n      show-details: always\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br")])]),e("h3",{attrs:{id:"微服务版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#微服务版"}},[a._v("#")]),a._v(" 微服务版")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("下载并部署arthas tunnel server")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("下载："),e("a",{attrs:{href:"https://github.com/alibaba/arthas/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("链接"),e("OutboundLink")],1)])]),a._v(" "),e("li",[e("p",[a._v("启动："),e("code",[a._v("java -jar arthas-tunnel-server.jar")]),a._v("启动服务")])]),a._v(" "),e("li",[e("p",[a._v("访问： http://localhost:8080/apps.html 即可看到所有注册的arthas列表")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images/image-20220727162134132.png",alt:"image-20220727162134132"}})])])])]),a._v(" "),e("li",[e("p",[a._v("其他服务中引入依赖后，加入下列配置（本质为注入服务到arthas tunnel server）")])])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("arthas:\n  tunnel-server: ws://127.0.0.1:7777/ws\n  app-name: event-management-service\n  http-port: -1  // -1为关闭监听\n  telnet-port: -1\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[a._v("部署实战")])]),a._v(" "),e("blockquote",[e("p",[a._v("Arthas由于需要用到jdk的tool工具，不支持通过jre启动，所以启动的时候需要指定jdk的地址下的java程序启动")]),a._v(" "),e("p",[e("code",[a._v("C:\\Program Files\\Java\\jdk1.8.0_321\\bin\\java -jar xxxx.jar")])]),a._v(" "),e("p",[a._v("项目通过joylau-springboot-daemon-windows插件，每次打包会打包成windows服务，所以修改其根目录下的xml文件即可")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images/image-20220810150248236.png",alt:"image-20220810150248236"}})])]),a._v(" "),e("h3",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[a._v("#")]),a._v(" 参考")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://arthas.aliyun.com/doc/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方文档"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.cn/post/6876809552784949261",target:"_blank",rel:"noopener noreferrer"}},[a._v("参考一"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.cn/post/6844904129060421640",target:"_blank",rel:"noopener noreferrer"}},[a._v("Arthas OOM定位"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.cn/post/6844903745323565064",target:"_blank",rel:"noopener noreferrer"}},[a._v("Arthas性能分析"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.cn/post/6844903953012899854#heading-8",target:"_blank",rel:"noopener noreferrer"}},[a._v("Arthas诊断"),e("OutboundLink")],1)])]),a._v(" "),e("h2",{attrs:{id:"二、visualvm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、visualvm"}},[a._v("#")]),a._v(" 二、VisualVM")]),a._v(" "),e("p",[e("strong",[a._v("VisualVM远程连接")]),a._v("：")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.jianshu.com/p/6d19e83aa1ea",target:"_blank",rel:"noopener noreferrer"}},[a._v("参考"),e("OutboundLink")],1)])]),a._v(" "),e("ol",[e("li",[a._v("远程服务启动时添加以下参数")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("-Dcom.sun.management.jmxremote=true \n-Dcom.sun.management.jmxremote.port=33306 \n-Dcom.sun.management.jmxremote.authenticate=false \n-Dcom.sun.management.jmxremote.ssl=false\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[e("p",[a._v("添加JMX远程连接")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images/image-20220712182846848.png",alt:"image-20220712182846848"}})])]),a._v(" "),e("li",[e("p",[a._v("确定连接")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontents.com/PI-KA-CHU/Image-OSS/main/images/image-20220712182947533.png",alt:"image-20220712182947533"}})])])]),a._v(" "),e("p",[a._v("GC记录")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("1. GC后MAX_HEAP增大，应该MAX和MIN没有设置成一样大小\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("问题记录：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("原因：接口请求一直处于pending状态，以为是JVM出了问题，接入VisualVM后发现运行正常")])]),a._v(" "),e("li",[e("p",[a._v("解决：后来在error日志中发现是redis连接错误，需要注意error日志，在out日志并不会打印错误，所以是因为reids一直阻塞导致的问题。")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);